

<!DOCTYPE html>
<html>
<head>
    <title>Current hurricane locations - Los Angeles Times</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">

    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/v1.2.0/mapbox-gl.css' />
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.4.1/mapbox-gl-geocoder.css' />

    <style type="text/css">body{margin:0;padding:0}footer,nav,.met-rule-1214,.met-promo-content,.met-flyout,.met-rule-538{display:none}#track-map{height:100%;width:100%;position:fixed;background:#cad2d3}.cityPoint,.stormName{background:none;border:none;box-shadow:none;opacity:1!important;cursor:default}.cityPoint{font-size:14px;font-family:'Benton Gothic Regular',Arial,sans-serif}.stormName{font-size:20px;font-weight:bold;font-family:'Benton Gothic Bold',Arial,sans-serif}.cityPoint:before,.stormName:before,.timeLabel:before{display:none}.timeLabel{background:none;border:none;box-shadow:none;font-size:14px;font-weight:bold;font-family:'Benton Gothic Bold',Arial,sans-serif}.storm-icon-spin{background-size:cover;width:30px;height:30px;border-radius:50%;cursor:pointer}.storm-icon-spin img{width:100%;display:block;-webkit-animation-name:spin;-webkit-animation-duration:4000ms;-webkit-animation-iteration-count:infinite;-webkit-animation-timing-function:linear;-moz-animation-name:spin;-moz-animation-duration:4000ms;-moz-animation-iteration-count:infinite;-moz-animation-timing-function:linear;-ms-animation-name:spin;-ms-animation-duration:4000ms;-ms-animation-iteration-count:infinite;-ms-animation-timing-function:linear;animation-name:spin;animation-duration:4000ms;animation-iteration-count:infinite;animation-timing-function:linear}@-ms-keyframes spin{from{-ms-transform:rotate(0deg)}to{-ms-transform:rotate(360deg)}}@-moz-keyframes spin{from{-moz-transform:rotate(0deg)}to{-moz-transform:rotate(360deg)}}@-webkit-keyframes spin{from{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(360deg)}}@keyframes spin{from{transform:rotate(360deg)}to{transform:rotate(0deg)}}#timezone{position:fixed;top:10px;right:10px;background-color:rgba(255,255,255,0.5);border-radius:4px;padding:4px 8px;font-family:Helvetica,Arial,sans-serif;font-size:14px}@media (max-width:600px){.leaflet-control-zoom{display:none}}</style>

    <script type="text/javascript" src="//d1qqc1e9kvmdh8.cloudfront.net/js/jquery-3.2.1/jquery-3.2.1.min.js"></script>

</head>
<body>

<div id="track-map"></div>

<div id="timezone">All times in Eastern time zone</div>

<script defer src='https://api.mapbox.com/mapbox-gl-js/v1.2.0/mapbox-gl.js'></script>
<script src="https://cdn.jsdelivr.net/npm/@turf/turf@5/turf.min.js"></script>

<script type="text/javascript">;$(document).ready(function(){function getParameterByName(name,url){if(!url)url=window.location.href;name=name.replace(/[\[\]]/g,'\\$&');var regex=new RegExp('[?&]'+name+'(=([^&#]*)|&|#|$)'),results=regex.exec(url);if(!results)return null;if(!results[2])return'';return decodeURIComponent(results[2].replace(/\+/g,' '));}
mapboxgl.accessToken='pk.eyJ1IjoibGF0aW1lcyIsImEiOiJjajhvcXRraGUwNnlwMzNyczR3cTBsaWh1In0.0cPKLwe2A0ET4P5CtWSiLQ';var stormAbbrvs={"TS":"Tropical storm","TD":"Tropical depression","STS":"Subtropical storm","STD":"Subtropical depression","DB":"Tropical disturbance","LO":"Remnant low","HU":"Hurricane","MH":"Major hurricane","H1":"Category 1 hurricane","H2":"Category 2 hurricane","H3":"Category 3 hurricane","H4":"Category 4 hurricane","H5":"Category 5 hurricane"};function convertUTCDateToLocalDate(date){var newDate=new Date(date.getTime()+date.getTimezoneOffset()*60*1000);var offset=date.getTimezoneOffset()/60;var hours=date.getHours();newDate.setHours(hours-offset);return newDate;}
$.ajax({dataType:"json",url:"https://latimes-graphics-media.s3.amazonaws.com/data/storms/currentGeoJSON.json",success:function(data){var forecastPoly;var stormName=getParameterByName('storm');var initBounds=[[-131.8359375,25.48295117535531],[-61.87499999999999,25.48295117535531],[-61.87499999999999,50.28933925329178],[-131.8359375,50.28933925329178],[-131.8359375,25.48295117535531]];if(stormName!=null){for(var i=0;i<data['features'].length;i++){if(data['features'][i]['geometry']['type']=='Polygon'&&data['features'][i]['properties']['storm'].toLowerCase()==stormName.toLowerCase()){forecastPoly=data['features'][i];}}
const combined=turf.combine(forecastPoly);const bbox=turf.bbox(combined);const bboxPoly=turf.bboxPolygon(bbox);const coordinates=bboxPoly['geometry']['coordinates'][0];const bounds=coordinates.reduce(function(bounds,coord){return bounds.extend(coord);},new mapboxgl.LngLatBounds(coordinates[0],coordinates[0]));initBounds=bounds;}
const map=new mapboxgl.Map({container:'track-map',style:'mapbox://styles/latimes/cjzx6n8lo075g1cpgyhviaqkj',pitchWithRotate:false,dragRotate:false,bounds:initBounds,center:[-74.50,40],fitBoundsOptions:{padding:{top:80,right:80,bottom:80,left:80},},interactive:false});map.scrollZoom.disable();const navigationControl=new mapboxgl.NavigationControl({showCompass:false,});function formatDate(date){var options={weekday:'short',hour:'numeric',timeZone:"America/New_York"};var cleanDate=date.toLocaleDateString("en-US",options);cleanDate=cleanDate.replace(',','.')
cleanDate=cleanDate.replace('AM','a.m.');cleanDate=cleanDate.replace('PM','p.m.');return cleanDate;}
for(var i=0;i<data['features'].length;i++){if(data['features'][i]['geometry']['type']=='Point'){if(data['features'][i]['properties']['source']=='forecast'){var storedDate=data['features'][i]['properties']['datetime'];storedDate+="Z";var storedDate=new Date(storedDate);var dispDate=formatDate(storedDate);data['features'][i]['properties']['datetime']=dispDate;}}}
var timezone=Intl.DateTimeFormat().resolvedOptions().timeZone.replace('_',' ');map.on('load',function(){map.addSource('storms',{type:'geojson',data:data,attribution:'Source: NOAA'});map.addLayer({"id":"cone-data","type":"fill","source":"storms","paint":{"fill-color":"#888888","fill-opacity":0.4},"filter":["==","$type","Polygon"]});map.addLayer({"id":"line-data","type":"line","source":"storms","paint":{"line-color":"#888888","line-opacity":1,"line-dasharray":[3,6],"line-width":1},"filter":["all",["==","$type","LineString"],["==","source","forecast"]]});map.addLayer({"id":"line-historical-data","type":"line","source":"storms","paint":{"line-color":"#888888","line-opacity":0.3,"line-width":1},"filter":["all",["==","$type","LineString"],["==","source","historical"]]});map.addLayer({"id":"point-data","type":"circle","source":"storms","paint":{"circle-radius":6,"circle-color":['match',['get','cat'],"TS","#f9e58c","TD","#fbf3b8","STS","#fbf3b8","STD","#fbf3b8","DB","#fbf3b8","LO","#fbf3b8","HU","#f7bb4f","MH","#9b291e","H1","#f7bb4f","H2","#e09643","H3","#c97237","H4","#b24e2a","H5","#9b291e",'#ccc'],"circle-opacity":['match',['get','source'],'forecast',1,'historical',0,0]},"filter":["==","$type","Point"]});map.addLayer({"id":"poi-labels","type":"symbol","source":"storms","layout":{"text-field":["get","datetime"],"text-variable-anchor":["top"],"text-radial-offset":0.5,"text-justify":"auto",},"filter":["all",["==","$type","Point"],["==","source","forecast"],["!=","current",true]]});for(var i=0;i<data['features'].length;i++){if(data['features'][i]['geometry']['type']=='Point'){if(data['features'][i]['properties']['current']==true){var el=document.createElement('div');el.className='storm-icon-spin storm-icon-'+data['features'][i]['properties']['cat'];var stormCat=data['features'][i]['properties']['cat'];var stormIconLoc=(stormCat==="MH"||stormCat==="H5"||stormCat==="H4"||stormCat==="H3")?"major_hurricane":(stormCat==="H2"||stormCat==="H1"||stormCat==="HU")?"hurricane":(stormCat==="TS")?"tropical_storm":"";el.innerHTML='<img src="static/'+stormIconLoc+'.png" />';var stormCoords=data['features'][i]['geometry']['coordinates'];new mapboxgl.Marker(el).setLngLat(stormCoords).addTo(map);}}}});}});});</script>

</body>
</html>
