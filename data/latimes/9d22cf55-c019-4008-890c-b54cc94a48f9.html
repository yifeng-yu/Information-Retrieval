<!DOCTYPE html>
<html lang="en" >
<head>

        
<script type="text/javascript">
    ((((window.trb || (window.trb = {})).data || (trb.data = {})).metrics || (trb.data.metrics = {})).thirdparty = {
        // Page naming convention:
        //  <site-slug>:<app-slug>:<path>:<datadesk-slug>-<page-slug>:<content-type>.
        // Example:
        //  lat:projects.latimes.com:local:data-pat-tillman:individualarticle.
        //  (Don't miss the period at the end.)
        pageName: 'lat:politics:la-pol-ca-california-governor-2018-money:individualarticle.',
        channel: 'politics', // Path
        server: 'www.latimes.com', // Full domain
        hier1: 'latimes:politics', // Path (with latimes prefix)
        hier2: 'politics', // Path (again)
        prop1: 'D=pageName',
        prop2: 'politics', // Path (again!)
        prop38: 'individualarticle', // Content type
        eVar1: window.location.href, // This URL
        eVar2: document.referrer, // The referring URL
        prop44: 'la-pol-ca-california-governor-2018-money',
        prop57: 'D=c38',
        prop59: 'Ryan Menezes and Maloy Moore',
        eVar20: 'latimes',
        eVar21: 'D=c38',
        eVar34: 'D=ch',
        eVar35: 'D=pageName',
        events: ''
    });
</script>
    
    <!--
                                              _..
      ____     _   _____   _     ___..-"""-.  `)^|   .-"""-..___    ____   _____  ____   _  __
     |  _ \   / \ |_   _| / \   `-...___ `=.`-.`  \-`.=` ___...-`  |  _ \ | ____|/ ___| | |/ /
     | | | | / _ \  | |  / _ \          `\  ` ##### `  /`          | | | ||  _|  \___ \ | ` /
     | |_| |/ ___ \ | | / ___ \           `--;|||||;--`            | |_| || |___  ___) || . \
     |____//_/   \_\|_|/_/   \_\             /\|||/\               |____/ |_____||____/ |_|\_\
    _______________________________________ ( /;-;\ ) _________________________________________
                                             `-...-`
    -->
    <!-- Created using v1.2.3 of the Los Angeles Times Data Desk's base templates -->
    <!-- Learn more at cookbook.latimes.com -->
    
    
    <!-- Good with data? -->
    <!-- Tired of grinding on the same old apps? -->
    <!-- Want to use your skills in defense of truth, justice and the American way? -->
    <!-- Email datadesk@latimes.com and let us know you're out there. -->
    

    <script type="text/javascript" src="//nexus.ensighten.com/caltimes/lat_datadesk_prod/Bootstrap.js"></script>

    
<script type='text/javascript'>var _sf_startpt=(new Date()).getTime()</script>


    <!-- METADATA -->
    <title>Track the millions flowing into California&#8217;s race for governor - Los Angeles Times</title>
    
        <meta charset="utf-8" />
        <meta name="description" content="Here&#8217;s where things stand as the Nov. 6 election approaches" />
        <meta name="keywords" content="data desk, los angeles times, latimes, l.a. times" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="apple-touch-icon" sizes="144x144" href="//d1qqc1e9kvmdh8.cloudfront.net/img/apple-touch-icon.png">
        <link rel="icon" type="image/x-icon" href="//d1qqc1e9kvmdh8.cloudfront.net/img/favicon-32x32.ico" sizes="32x32">
        <link rel="icon" type="image/x-icon" href="//d1qqc1e9kvmdh8.cloudfront.net/img/favicon-16x16.ico" sizes="16x16">
        <link rel="publisher" href="//plus.google.com/u/0/112727226361732924638" />
        <meta name="google-site-verification" content="a9pAUAoFTyj7Nut3H5OiQ-fUyyqdwdVT7VcFGICrpTo" />
        
    
        
        <link rel="canonical" href="https://www.latimes.com/projects/la-pol-ca-california-governor-2018-money/">
    

    
    
    <meta property="og:title" content="Track the millions flowing into California's race for governor"/>
    
    <meta property="og:type" content="article"/>
    <meta property="og:url" content="https://www.latimes.com/projects/la-pol-ca-california-governor-2018-money/" />
    <meta property="og:image" content="https://www.trbimg.com/img-5b688538/turbine/la-me-pol-2018-gov-money-share-image/600"/>
    <meta property="og:site_name" content="www.latimes.com"/>
    <meta property="og:description" content="Here's where things stand as the Nov. 6 election approaches"/>
    <meta property="fb:admins" content="1257725335"/>
    <meta property="fb:app_id" content="171740782909828" />
    <meta property="twitter:site" content="@latimes" />
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://www.latimes.com/projects/la-pol-ca-california-governor-2018-money/" />
    
    <meta property="twitter:title" content="Track the millions flowing into California's race for governor" />
    
    <meta property="twitter:description" content="Here's where things stand as the Nov. 6 election approaches" />
    <meta property="twitter:image" content="https://www.trbimg.com/img-5b688538/turbine/la-me-pol-2018-gov-money-share-image/600" />
    <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "NewsArticle",
      
      "headline": "Track the millions flowing into California\u0027s race for governor",
      
      "image": {
          "@type": "ImageObject",
          "contentUrl": "https://www.trbimg.com/img-5b688538/turbine/la-me-pol-2018-gov-money-share-image/600",
          "url": "https://www.trbimg.com/img-5b688538/turbine/la-me-pol-2018-gov-money-share-image/600",
          "representativeOfPage": true
      },
      "datePublished": "2018-11-05",
      "description": "Here's where things stand as the Nov. 6 election approaches",
      "publisher": {
          "@type": "Organization",
          "name": "Los Angeles Times",
          "url": "http://www.latimes.com",
          "location": {
              "@type": "Place",
              "name": "Los Angeles"
          },
          "logo": {
              "@type": "ImageObject",
              "contentUrl": "http://cookbook.latimes.com/img/ngux-tophat/logos/lat_logo_730_black.png",
              "url": "http://cookbook.latimes.com/img/ngux-tophat/logos/lat_logo_730_black.png"
          }
      },
      "author": {
          "@type": "Person",
          "name": "Ryan Menezes and Maloy Moore"
      }
    }
    </script>
    

    

    <!-- CSS -->
    
    <link rel="stylesheet" type="text/css" href="//d1qqc1e9kvmdh8.cloudfront.net
/bootstrap/2.3.2/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="//d1qqc1e9kvmdh8.cloudfront.net/css/ngux-tophat-1.2.3.min.css" />
    <link rel="stylesheet" type="text/css" href="//d1qqc1e9kvmdh8.cloudfront.net/bootstrap/2.3.2/css/bootstrap-responsive.min.css" />
    <link rel="stylesheet" type="text/css" href="//d1qqc1e9kvmdh8.cloudfront.net/css/ngux-tophat-responsive-1.2.3.min.css" />
    

    
    <style type="text/css">/*universal section styles*/
section,
aside {
  max-width: 950px;
  margin: 50px auto;
}
section[name="credits"]{
  margin: 30px auto;
}
section[name="maps"]{
  margin-bottom: 20px;
}
.display_none {
  display:none !important;
}
.lower {
  text-transform: none !important;
}

/*adjustments to the header*/
header.center h1{
  max-width: 880px;
}
header.center p.description{
  max-width: 600px;
}

/*candidate leader board styles*/

.candholder {
  display: flex;
  flex-direction: row;
  justify-content:space-around;
}
  .cand {
    flex: 1 1 300px;
  }

.stuff {
  display: grid;
  grid-template-columns: 50% 50%;
}
  .box {
    padding: 10px;
  }

  .photo {
    grid-column: 1;
    grid-row: 1 / 3;

    display: flex;
    align-items: center;
    justify-content: center;
  }
  img.thumb {
    background: #ccc;
    width: 100%;
    max-width:150px;
  }

  .name {
    grid-column: 2;
    grid-row: 1;
    align-self: end;

    font-family: 'Benton Gothic Regular',Arial,sans-serif;
    font-weight: normal;
  }
  .candidate_name {
    font-size:17px;
    display: block;
  }
  .candidate_description {
    font-size:12px;
    display: block;
  }

  .money {
    grid-column:2;
    grid-row: 2;
  }
  .big_number {
    font-weight: normal;
    font-family: 'Benton Gothic Bold',Arial,sans-serif;
    font-size:40px;
  }
  .millions {
    font-weight: normal;
    font-family: 'Benton Gothic Regular',Arial,sans-serif;
    font-size:12px;
    font-style: italic;
  }

@media(max-width: 768px){
  .candholder {
    flex-direction: column;
  }
    .cand {
      flex: 0 1;
    }
}

@media(max-width: 979px) {
  .big_number {
    display: block;
  }
  .millions {
    display: block;
    margin-top: 10px;
  }
}

.hedbreak {
  display: none;
}
@media(min-width: 605px) and (max-width: 979px) {
  .hedbreak {
    display: inline;
  }
}

/*ie leader board styles*/

.ie_rank {
  font-size: 26px;
  /*vertical-align: middle!important;*/
  font-family: 'Benton Gothic Bold',Arial,sans-serif;
  width: 5%;
  padding-right: 0;
}

.ie_comm_name {
  font-family: 'Benton Gothic Bold',Arial,sans-serif;
  font-size: 16px;
}

.ie_stances {
  font-style: italic;
}

.ie_description {
  /*font-size: 12px;*/
}

/*d3 chart styles*/

.morelink {
  font-size: 14px;
}

.chart-holder.cumulative{
  margin:0 0;
}

figure.content-fit {
  /*max-width: 950px;*/
  margin-left: auto;
  margin-right: auto;
}

.candidate .line {
  fill: none;
  stroke-width: 2.5px;
}

.candidate#villaraigosa,
.candidate#chiang,
.candidate#allen {
  opacity: 50%;
}

.axis path,
.axis line {
  fill: none;
  stroke: #666;
  shape-rendering: crispEdges;
}
.y.axis path{display: none}
.y.axis .tick line {fill:none; stroke-width:0;}
.y.grid .tick line {fill:#000; stroke-width:1; stroke:#ddd; stroke-dasharray: 3, 6px;}

.x.axis path,
.x.axis line {
  fill: none;
  stroke: #ddd;
}
.tick text,
.text-label text {
  fill: #666;
  font-size: 16px;
  font-family: 'Benton Gothic Regular', Arial, sans-serif;
}

.vline text {
  fill: #666;
  font-size: 12px;
  font-family: sans-serif;
  font-family: 'Benton Gothic Regular', Arial, sans-serif;
}

p.creditline {
  margin: 5px 0;
  font-family: 'Benton Gothic Regular', Arial, sans-serif;
  color: #666;
  font-size: 12px;
  line-height: 17px;
}

/*donor table styles*/

.donor_row {
  border-bottom: 1px dotted #ccc;
}
.donor_row h4 {
    font-family: 'Benton Gothic Bold', Arial, sans-serif;
    font-weight: normal;
}
.donor_row p {
    font-family: 'Benton Gothic Regular', Arial, sans-serif;
    margin: 5px 0;
    font-size:16px;
}
h4.donor_amount {
  text-align: right;
  vertical-align: center;

}
.recipient {
  padding: 25px 0;
}
.recipient_name {
  font-family: 'Belizio Narrow SemiBold', Georgia, serif;
  font-size: 25px;
}
.recipient_info {
  font-family: Arial, sans-serif;
  font-weight: normal;
  font-size: 16px;
  padding-left: 4px;
}

/*map styles*/


.mapholder{
  width:100%;
  display: flex;
  flex-flow: row wrap;
  justify-content: space-around;
  align-items: flex-start;
  align-content: flex-start;
}

.map-text-holder {
  text-align: center;
}

.map-text-holder h3 {
  font-family: 'Benton Gothic Bold', Arial, sans-serif;
  font-weight: normal;
  font-size: 25px;
}

/* cox */

.bar {
  height: 40px;
  border: none;
  float: left;
}

.barlabel {
  font-size: 12px;
  font-weight: normal;
  font-family: 'Benton Gothic Bold', Arial, sans-serif;
}

.self {background-color: #cf7331}
.other {background-color: #D4D6D7}

/* sector tree styles */

.treeholder {
  width: 100%;
  display: flex;
  flex-flow: row wrap;
  justify-content: space-around;
  align-items: flex-start;
  align-content: flex-start;
}

.tree-text-holder {
  width: 200px;
  display:block;
}
.tree-text-holder h3 {
  font-family: 'Benton Gothic Bold', Arial, sans-serif;
  font-weight: normal;
  font-size: 13px;
  line-height: 9px;
}

.tree-text-holder h3 a {
  font-family: 'Benton Gothic Regular', Arial, sans-serif;
  font-weight: normal;
  font-size: 11px;
  color: #4591B8;
}

.tree-text-holder h3.total {
  font-family: 'Benton Gothic Regular', Arial, sans-serif;
}

.sector-text {
  width:150px;
  margin:0 25px 5px 25px;
}

button.sector_toggle {
  margin: 10px 0;
}

.annotations path {
    fill: none;
    stroke: #000;
}

.annotations text {
  font-family: 'Benton Gothic Regular', Arial, sans-serif;
  font-weight: normal;
  font-size: 11px;
  fill: #000;
}

#arrow path {
  stroke: #000;
  fill: #000;
}

#tree_native_american_tribes .annotations path,
#tree_cannabis .annotations path,
#tree_agriculture .annotations path,
#tree_cannabis rect[data-blktype="outline"] {
  display: none;
}

/*media queries*/



@media(max-width: 768px) {
  h4.donor_amount{
    text-align: left;
  }
  td.candidate_name {
    min-width: auto;
  }
  .map-text-holder{

  }
}

@media(max-width: 600px){
  article.big-build header.center p.description,
  article.big-build header.center p.byline,
  article.big-build header.center p.dateline{
    text-align: left;
    margin-left: 0;
    margin-right: 0;
  }
}

@media(max-width: 480px){
    h1 {
        font-size: 32px;
        line-height: 1.15em;
    }
    h3 {
        font-size: 20px;
    }
    h4 {
        margin-top: 10px;
    }
    .donor_row p {
        font-size: 15px;
        line-height: 24px;
    }
}
/*
@media(max-width: 420px){
  .priority-two{
    display:none;
  }
}

@media(max-width: 979px){
  .priority-three{
    display:none;
  }
}*/
</style>


    <!-- JAVASCRIPT -->
    
    
    <!--[if lt IE 9]>
          <script type="text/javascript" src="//d1qqc1e9kvmdh8.cloudfront.net/js/html5shiv.js"></script>
     <![endif]-->
    
    <script type="text/javascript" src="//d1qqc1e9kvmdh8.cloudfront.net/js/jquery-3.2.1/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="//d1qqc1e9kvmdh8.cloudfront.net/bootstrap/2.3.2/js/bootstrap.min.js"></script>
    <script src="//d1qqc1e9kvmdh8.cloudfront.net/js/underscore-1.8.3-min.js" type="text/javascript"></script>
    <script type="text/javascript" src="https://cdns.gigya.com/js/socialize.js?apiKey=2_COh26GgfZDptreu0iQ9aknzT_Ig861qYxOHZVxizrZMTn81vygTB-ptN33wgCtrj"></script>
    <script type="text/javascript" src="//d1qqc1e9kvmdh8.cloudfront.net/js/ngux-tophat-1.2.3.min.js"></script>
    <!--[if lte IE 7]><script type="text/javascript" src="//d1qqc1e9kvmdh8.cloudfront.net/js/icons-ie7.js"></script><![endif]-->
    <script type="text/javascript" src="//d1qqc1e9kvmdh8.cloudfront.net/js/ngux-ads-2.4.2.min.js"></script>
    

    
    
    
</head>
<body data-ad-slug="la-pol-ca-california-governor-2018-money" data-ad-path="4011/trb.latimes/news/datadesk" data-ad-ptype="s" data-ad-iframe-url="/projects/static/ngux-tophat-ad-iframe.html" >
    <!-- NAV -->
    
    
        
            
        
    
    
    <nav title="Navigation">
        <div id="tophat-container">
    <div id="tophat">
        
            <span id="tophat-dropdown">
                <hr />
                <hr />
                <hr />
            </span>
            
                <a id="tophat-logo" href="//www.latimes.com/"></a>
            
            
            <div class="pull-right">
                <a href="http://ad.latimes.com/land-subscribe-evergreen/editorialnav.html?int=lat_digitaladshouse_4-weeks-99_acquisition-subscriber_ngux_button_editorial_______nav-subscribe-button">
                  <div class="subscribe-button">Subscribe
                     <span id="price">4 weeks for 99¢</span>
                  </div>
                </a>
            </div>
            
            
                <div class="tophat-links">
                    <ul>
    <li>
        <a href="//www.latimes.com/local">Local</a>
    </li>
    <li>
        <a href="//www.latimes.com/california">California</a>
    </li>
    <li>
        <a href="//www.latimes.com/sports">Sports</a>
    </li>
    <li>
        <a href="//www.latimes.com/entertainment">Entertainment</a>
    </li>
    <li>
        <a href="//www.latimes.com/nation">Nation</a>
    </li>
    <li>
        <a href="//www.latimes.com/world">World</a>
    </li>
    <li>
        <a href="//www.latimes.com/business">Business</a>
    </li>
    <li>
        <a href="//www.latimes.com/opinion">Opinion</a>
    </li>
    <li>
        <a href="//www.latimes.com/style">Lifestyle</a>
    </li>
    <li>
        <a href="//www.latimes.com/travel">Travel</a>
    </li>
</ul>

                </div>
            
        
    </div>
</div>

    </nav>
    


    
<article class="container big-build">
    <header class="center">
        <div class="sharebuttons clearfix"
    
    
    
    
    >
    <i class="LATFacebook" data-socialshare-type="facebook"></i>
    <i class="LATTwitter" data-socialshare-type="twitter" ></i>
    <i class="LATEmail" data-socialshare-type="email"></i>
</div>

        <h1>Track the millions flowing into California&#8217;s race for governor</h1>
        <p class="byline">
            By <span class="author"><a href="http://www.latimes.com/la-bio-ryan-menezes-staff.html">Ryan Menezes</a> and <a href="http://www.latimes.com/la-bio-maloy-moore-staff.html">Maloy Moore</a></span>
        </p>
        <p class="dateline">
            <time datetime="2018-11-05" pubdate>
                Updated Nov. 5, 2018
            </time>
        </p>
        <p class="description">Here&#8217;s where things stand as the Nov. 6 election approaches</p>
    </header>

    <a name="leaderboard"></a>
    <section name="summary">
        

<h2>Who&#39;s raised the most?</h2>
<p>Democrat Gavin Newsom has amassed a massive money pile since starting his campaign more than three years ago. His total is more than three times that of Republican John Cox.</p>

<div class="candholder">
  
  
  

  <div class="cand">
    <div class="stuff">
      <div class="box photo">
        <img class="thumb img-circle" src="/projects/la-pol-ca-california-governor-2018-money/static/img/newsom.png">
      </div>
      <div class="box name">
        <span class="candidate_name">Gavin Newsom (D)</span>
        <span class="candidate_description">Lieutenant governor</span>
      </div>
      <div class="box money">
        <span class="big_number">$58.2</span>
        <span class="millions">million</span>
      </div>
    </div>
  </div>

  
  
  
  
  
  
  
  
  

  <div class="cand">
    <div class="stuff">
      <div class="box photo">
        <img class="thumb img-circle" src="/projects/la-pol-ca-california-governor-2018-money/static/img/cox.png">
      </div>
      <div class="box name">
        <span class="candidate_name">John Cox (R)</span>
        <span class="candidate_description">Businessman</span>
      </div>
      <div class="box money">
        <span class="big_number">$16.8</span>
        <span class="millions">million</span>
      </div>
    </div>
  </div>

  
  
  
</div>

    </section>

    <a name="tracker"></a>
    <section name="cumulative">
        <h2>Fundraising slowed after the primary</h2>
<p>Newsom and Cox have raised about $20 million combined since they <a href="http://www.latimes.com/projects/la-pol-ca-california-primary-election-results-2018/">triumphed</a> on June 5. That's a stark drop from the <a target="_blank" href="/projects/la-pol-ca-california-governor-2018-money-primary/">massive infusions</a> into candidates' accounts in the weeks before the primary election.</p>

<figure class="content-fit">
<div class="chart-holder cumulative">
  <div id="chart" class="chart">
    <svg id='tracker'></svg>
  </div>
  <p class="creditline">Note: Contributions from small donors, whom committees do not have to identify, are included as lump sums on the day totals were reported. A small number of contributions without a date disclosed have been excluded.</p>
</div>
</figure>

    </section>

    <a name="cox"></a>
    <section name="coxtoself">
        
<h2>Cox has one major donor</h2>
<p>Himself. The businessman, estimated to be worth more than $100 million, kickstarted his longshot campaign with millions from his personal bank account. His giving has continued. After advancing to the general election, Cox sent an additional $700,000 to his campaign.</p>


<div class="barsection" style="width: 100%; max-width:500px; display: inline-block;">
	<div class="barlabel top" style="float:left; display:block; clear:both;">Cox: $5.7 million</div>
	<div style="display:block; clear:both;">
		<div class="bar self" style="width:34%"></div>
		<div class="bar other" style="width:66%"></div>
	</div>
	<div class="barlabel bottom" style="float:right">Others:  $11.1 million</div>
</div>


    </section>

    <a name="maps"></a>
    <section name="maps">
      <h2>Where does the money come from?</h2>
<p>Newsom has won support from power centers across the state, including Hollywood, Sacramento and his home base of San Francisco. Cox's strongest fundraising comes from his adopted home of San Diego, where he <a href="http://www.latimes.com/projects/la-pol-ca-california-primary-election-results-2018/">won the vote</a> in June and has pulled in more than $1 million.</p>
<div class='mapholder' id='maps'>
	<div class="map-text-holder" id="map-text-newsom" style="text-align: center;">
		<h3>Newsom</h3>
		<div class="map newsom">
			<svg id="mapnewsom"></svg>
		</div>
	</div>
	<div class="map-text-holder" id="map-text-cox" style="text-align: center;">
		<h3>Cox</h3>
		<div class="map cox">
			<svg id="mapcox"></svg>
		</div>
	</div>
</div>

    </section>
    
    <a name="donors"></a>
    <section name="donors">
        

<h2>Who’s writing the checks?</h2>
<p>Here are some of the top donors to each campaign.</p>






<div class="recipient row-fluid" style="padding-top: 0;">
  <div class="span1 hidden-phone hidden-tablet">
    <img class="thumb img-circle" style="width:100%; height:auto;" src="/projects/la-pol-ca-california-governor-2018-money/static/img/newsom.png">
  </div>
  <div class="span11">
    <h3>Gavin Newsom</h3>
    <p style="margin-bottom: 0px;">Newsom’s donor list includes some of the state&#39;s strongest interest groups, as well as famous names from across the country. He also has the most money from small donors, whose identities are not disclosed.</p>
  </div>
</div>

























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































<div class="row-fluid">
  <div class="span1 hidden-phone hidden-tablet"></div>
  <div class="donor_row span11">
    <div class="row-fluid">
    <div class="span9">
      <h4>California Teachers Assn.</h4>
      <p>Powerful force in California politics that advocates for teachers in public schools and colleges</p>
    </div>
    <div class="span3">
      <h4 class="donor_amount">$1,157,484</h4>
    </div>
  </div>
  </div>
</div>

























































































































































































































































<div class="row-fluid">
  <div class="span1 hidden-phone hidden-tablet"></div>
  <div class="donor_row span11">
    <div class="row-fluid">
    <div class="span9">
      <h4>Blue Shield of California</h4>
      <p>San Francisco-based health insurer. Has also backed anti-Chiang outside group.</p>
    </div>
    <div class="span3">
      <h4 class="donor_amount">$1,038,440</h4>
    </div>
  </div>
  </div>
</div>























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































<div class="row-fluid">
  <div class="span1 hidden-phone hidden-tablet"></div>
  <div class="donor_row span11">
    <div class="row-fluid">
    <div class="span9">
      <h4>Stewart and Lynda Resnick</h4>
      <p>Billionaire couple behind Fiji Water and POM Wonderful juice. Have given to both Newsom and Villaraigosa.</p>
    </div>
    <div class="span3">
      <h4 class="donor_amount">$116,800</h4>
    </div>
  </div>
  </div>
</div>













































































































































































































































































































































































































































































































































































































































































































































<div class="row-fluid">
  <div class="span1 hidden-phone hidden-tablet"></div>
  <div class="donor_row span11">
    <div class="row-fluid">
    <div class="span9">
      <h4>Marissa Mayer and Zachary Bogue</h4>
      <p>Former CEO of Yahoo and her husband, a Silicon Valley investor</p>
    </div>
    <div class="span3">
      <h4 class="donor_amount">$115,800</h4>
    </div>
  </div>
  </div>
</div>











































































































































































































































































































































































































































































































































































































































































<div class="row-fluid">
  <div class="span1 hidden-phone hidden-tablet"></div>
  <div class="donor_row span11">
    <div class="row-fluid">
    <div class="span9">
      <h4>Laurene Powell Jobs</h4>
      <p>Widow of Steve Jobs and founder of Emerson Collective, an organization supporting education, immigration reform and social justice</p>
    </div>
    <div class="span3">
      <h4 class="donor_amount">$58,400</h4>
    </div>
  </div>
  </div>
</div>



















































































































































































































































































































































<div class="row-fluid">
  <div class="span1 hidden-phone hidden-tablet"></div>
  <div class="donor_row span11">
    <div class="row-fluid">
    <div class="span9">
      <h4>Andrew Hauptman</h4>
      <p>Chairman of private investment firm Andell Inc.</p>
    </div>
    <div class="span3">
      <h4 class="donor_amount">$58,400</h4>
    </div>
  </div>
  </div>
</div>





































































































































































































































































































































































































































































<div class="row-fluid">
  <div class="span1 hidden-phone hidden-tablet"></div>
  <div class="donor_row span11">
    <div class="row-fluid">
    <div class="span9">
      <h4>Peter Thiel</h4>
      <p>Venture capitalist and PayPal co-founder who supported Republican Donald Trump in 2016 presidential election</p>
    </div>
    <div class="span3">
      <h4 class="donor_amount">$57,400</h4>
    </div>
  </div>
  </div>
</div>

























































































































































































































































<div class="row-fluid">
  <div class="span1 hidden-phone hidden-tablet"></div>
  <div class="donor_row span11">
    <div class="row-fluid">
    <div class="span9">
      <h4>George Soros</h4>
      <p>Chairman of an investment management firm and philanthropist. Leading benefactor of Democratic candidates.</p>
    </div>
    <div class="span3">
      <h4 class="donor_amount">$57,400</h4>
    </div>
  </div>
  </div>
</div>



































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































<div class="row-fluid">
  <div class="span1 hidden-phone hidden-tablet"></div>
  <div class="donor_row span11">
    <div class="row-fluid">
    <div class="span9">
      <h4>Bill Maher</h4>
      <p>Entertainer and host of HBO&#39;s &quot;Real Time,&quot; who has encouraged Newsom to run for president in 2020</p>
    </div>
    <div class="span3">
      <h4 class="donor_amount">$48,200</h4>
    </div>
  </div>
  </div>
</div>







































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































<div class="row-fluid">
  <div class="span1 hidden-phone hidden-tablet"></div>
  <div class="donor_row span11">
    <div class="row-fluid">
    <div class="span9">
      <h4>Marshawn Lynch</h4>
      <p>NFL running back, currently with the Oakland Raiders</p>
    </div>
    <div class="span3">
      <h4 class="donor_amount">$1,000</h4>
    </div>
  </div>
  </div>
</div>







































































































































<div class="recipient row-fluid" style="">
  <div class="span1 hidden-phone hidden-tablet">
    <img class="thumb img-circle" style="width:100%; height:auto;" src="/projects/la-pol-ca-california-governor-2018-money/static/img/cox.png">
  </div>
  <div class="span11">
    <h3>John Cox</h3>
    <p style="margin-bottom: 0px;">Cox&#39;s donor list, headed by himself, is much shorter.</p>
  </div>
</div>























































































































































































































































































































































































<div class="row-fluid">
  <div class="span1 hidden-phone hidden-tablet"></div>
  <div class="donor_row span11">
    <div class="row-fluid">
    <div class="span9">
      <h4>John Cox</h4>
      <p>The candidate has largely drawn on his own checkbook to fund his campaign.</p>
    </div>
    <div class="span3">
      <h4 class="donor_amount">$5,508,074</h4>
    </div>
  </div>
  </div>
</div>































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































<div class="row-fluid">
  <div class="span1 hidden-phone hidden-tablet"></div>
  <div class="donor_row span11">
    <div class="row-fluid">
    <div class="span9">
      <h4>Geoff Palmer</h4>
      <p>Real estate developer with multiple apartment complexes in Downtown L.A. One of the top donors to President Trump.</p>
    </div>
    <div class="span3">
      <h4 class="donor_amount">$529,200</h4>
    </div>
  </div>
  </div>
</div>





































































































































































































































































































































































































































































































































































<div class="row-fluid">
  <div class="span1 hidden-phone hidden-tablet"></div>
  <div class="donor_row span11">
    <div class="row-fluid">
    <div class="span9">
      <h4>Melba Jean and Floyd Kvamme</h4>
      <p>Founder of Lichen Oaks Adaptive Riding Center, a therapeutic horseback riding center in Santa Cruz, and her husband</p>
    </div>
    <div class="span3">
      <h4 class="donor_amount">$168,400</h4>
    </div>
  </div>
  </div>
</div>



































































































































































































































































































































































































































































































































































































<div class="row-fluid">
  <div class="span1 hidden-phone hidden-tablet"></div>
  <div class="donor_row span11">
    <div class="row-fluid">
    <div class="span9">
      <h4>Professional Financial Investors, Inc.</h4>
      <p>Property investment and management firm in Marin and Sonoma counties</p>
    </div>
    <div class="span3">
      <h4 class="donor_amount">$149,000</h4>
    </div>
  </div>
  </div>
</div>























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































<div class="row-fluid">
  <div class="span1 hidden-phone hidden-tablet"></div>
  <div class="donor_row span11">
    <div class="row-fluid">
    <div class="span9">
      <h4>Thomas and Carolyn Dauterman</h4>
      <p>Owner of Thomas Manufacturing, a manufacturer of nut harvesting equipment in Chico, and his wife</p>
    </div>
    <div class="span3">
      <h4 class="donor_amount">$49,200</h4>
    </div>
  </div>
  </div>
</div>

































































































































































































































































































































































































































<div class="row-fluid">
  <div class="span1 hidden-phone hidden-tablet"></div>
  <div class="donor_row span11">
    <div class="row-fluid">
    <div class="span9">
      <h4>Humberto Lopez</h4>
      <p>President of HSL Properties Inc., which owns and operates apartment communities in Arizona</p>
    </div>
    <div class="span3">
      <h4 class="donor_amount">$31,350</h4>
    </div>
  </div>
  </div>
</div>






























































































































































































































































































































































































































































































































































































































































































































































































































































    </section>

    <section name="credits">
        
            <p class="sources">Sources: California secretary of state, <a href="http://www.californiacivicdata.org/">California Civic Data Coalition</a>, Mapzen, Times analysis</p>
        
        <p class="sources">About the data: Totals on this page include all contributions made to the candidates&#8217; gubernatorial committees and other groups working on a candidate&#8217;s behalf. The records are drawn from two sources: first, periodic disclosure reports filed with the California secretary of state, which cover donations through June 30, 2018; second, reports of donations greater than $5,000 since then, which must be disclosed soon after they are received. This page was originally published Aug. 6, 2018 and will be updated as the campaign progresses.</p>
        
            <p class="credits">Credits: Photo editing by Andrea Roberson, development by Ben Welsh and Andrew Briz, classification algorithm by Anthony Pesce</p>
        
    </section>

    <aside class="mlt">
    <h2>More from the Los Angeles Times</h2>
    <ul>
        
        <li>
            <figure>
                <a href ="http://www.latimes.com/politics/la-pol-ca-california-governor-debate-20181008-story.html">
                    <img src="https://www.latimes.com/resizer/o0E9B4wpL0TQYefZLIVyUhWAzx8=/1400x0/www.trbimg.com/img-5bbba6fb/turbine/la-1539024630-xrf0o3z4ky-snap-image">
                </a>
            </figure>
            <a href ="http://www.latimes.com/politics/la-pol-ca-california-governor-debate-20181008-story.html">
                <span>Gavin Newsom and John Cox clash in their only head-to-head governor's race debate</span>
            </a>
        </li>
        
        <li>
            <figure>
                <a href ="http://www.latimes.com/politics/la-pol-ca-usc-latimes-poll-governor-20181017-story.html">
                    <img src="https://www.latimes.com/resizer/FTBBmPy5rH72OtktYU1656u1bNg=/1400x0/www.trbimg.com/img-5bc532b5/turbine/la-1539650225-ny4s4u6ych-snap-image">
                </a>
            </figure>
            <a href ="http://www.latimes.com/politics/la-pol-ca-usc-latimes-poll-governor-20181017-story.html">
                <span>Poll shows Newsom with a commanding lead over Cox in final weeks before election</span>
            </a>
        </li>
        
        <li>
            <figure>
                <a href ="http://www.latimes.com/politics/la-pol-ca-california-governor-race-john-cox-bus-20180927-story.html">
                    <img src="https://www.latimes.com/resizer/GOgkqR5hkkJEP7HBEbZ73LfWsIA=/1400x0/www.trbimg.com/img-5bac30f5/turbine/la-1538011377-jy3iramjv5-snap-image">
                </a>
            </figure>
            <a href ="http://www.latimes.com/politics/la-pol-ca-california-governor-race-john-cox-bus-20180927-story.html">
                <span>John Cox launches bus tour, telling voters 'help is on the way'</span>
            </a>
        </li>
        
        <li>
            <figure>
                <a href ="http://www.latimes.com/projects/la-pol-ca-next-california-candidates-respond/">
                    <img src="https://www.trbimg.com/img-5b995752/turbine/la-lb-media-la_me_newsom_cox-20180912-111335/600">
                </a>
            </figure>
            <a href ="http://www.latimes.com/projects/la-pol-ca-next-california-candidates-respond/">
                <span>Here's how the candidates see what's next for California</span>
            </a>
        </li>
        
    </ul>
</aside>

</article>



    

        <!-- Google Analytics code -->
        <script type="text/javascript">
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-65208330-4', 'latimes.com');
              ga('send', 'pageview');
        </script>



    

    
    
    <footer title="Footer">
        <nav id="footer-container">
    <div id="footer">
        
            
                <div id="tos">
                    <a href="//www.tronc.com/central-terms-of-service/">Terms of Service</a> |
                    <a href="//www.tronc.com/privacy-policy/">Privacy<span class="hidden-phone"> Policy</span></a> |
                    <a href="//www.latimes.com/lat-about-our-ads,0,3875412.htmlstory"><span class="hidden-phone">About Our </span>Ads</a> |
                    <a href="//www.latimes.com/services/site/la-reprint-request-splash,0,6731163.htmlstory">&copy; <script type="text/javascript">document.write(new Date().getFullYear())</script></a> |
                    <a href="//www.latimes.com/about/"><span class="hidden-phone">About This Site</span></a>
                </div>
            
        
    </div>
</nav>

    </footer>
    
    <script type="text/javascript" src="//ssor.tribdss.com/reg/tribune/lanews-static.min.js" defer async></script>
    
    <script type="text/javascript" src="//dss.platform.californiatimes.com/meter/latspot.min.js" defer async></script>
    
    <script type="text/javascript">(window.registration || (registration = [])).push('viafoura');</script>


    
    <script src="//d1qqc1e9kvmdh8.cloudfront.net/js/d3-3.5.6/d3.min.js"></script>
    <script type="text/javascript" src="static/js/queue.js"></script>
    <script type="text/javascript" src="static/js/topojson.js"></script>
    <script type="text/javascript" src="static/js/d3-legend.min.js"></script>
    <script type="text/javascript" src="static/js/archieml.js"></script>
    <script type="text/javascript" src="static/js/swoopy-drag.js"></script>
    <script type="text/javascript" src="static/js/d3-jetpack.js"></script>
    <script type="text/javascript">;
var app = {}

app.toptwo = ['Gavin Newsom', 'John Cox']
app.eliminated = "#333"

// mapping candidates to colors ****this is used frequently****
app.colorScale = d3.scale.ordinal()
  .domain([
    "Gavin Newsom",
    "Antonio Villaraigosa",
    "John Chiang",
    "John Cox",
    "Travis Allen",
  ])
  .range(["#007abf",app.eliminated,app.eliminated,"#dc4e54", app.eliminated]);

app.boot = function (error, cumulative, california, counties, outofstate, sectors) {

  app.windowWidth = window.innerWidth;
  app.isMobile = app.windowWidth <= 767 ? true : false;

  // read and process data
  app.cumulative = app.prepCumData(cumulative);
  app.california = california;
  app.counties = app.prepCaData(counties);
  app.centroids = app.prepCentroids(counties);
  app.outofstate = {}
  _.map(outofstate, function(d) {
    app.outofstate[d['candidate_name']] = +d['amount']
  })
  app.sectors = sectors;

  app.drawChart();

  app.drawMap("Gavin Newsom");
  app.drawMap("John Cox");

  window.addEventListener('resize', app.resizeAll);
}

app.resizeAll = function(){
  app.windowWidth = window.innerWidth;
  app.isMobile = app.windowWidth <= 767 ? true : false;

  app.drawChart();
  app.drawMap("Gavin Newsom");
  app.drawMap("John Cox");
}

// other files

/*****

    CHART DATA PROCESSING

*****/

// prep each row of csv
app.prepCumRow = function (d) {
  return {
    date: d3.time.format("%Y-%m-%d").parse(d.date),
    "Gavin Newsom": +d["Gavin Newsom"],
    "John Chiang": +d["John Chiang"],
    "Antonio Villaraigosa": +d["Antonio Villaraigosa"],
    "John Cox": +d["John Cox"],
    "Travis Allen": +d["Travis Allen"],
  }
}

// convert to one object per candidate
app.prepCumData = function(rawdata){
  var data =_.map(rawdata, app.prepCumRow);

  var candidates = app.colorScale.domain().map(function(name){
    return {
      candidate: name,
      values: data.map(function(d){
        return {date: d.date, raised: d[name]}
      })
    }
  })

  // keep only the dates where this candidate raised money, plus one day before
  var trimmed_candidates = candidates.map(function(c){
    var thiscandidatesdates = _.filter(c.values,
      function(d,i){
        var nextd = c.values[i+1];
        if (nextd) {
          var nextvalue = nextd["raised"]
        } else {
          var nextvalue = -1
        }
        var value = d["raised"]
        if (value > 0 || nextvalue > 0) {
          return true
        } else {
          return false
        }
      }
    );
    return {
      candidate: c.candidate,
      values: thiscandidatesdates
    }
  });
  return trimmed_candidates;
}

/*****

    CHART DRAWING

*****/

// line path to draw based on x and y scales
app.lineDraw = d3.svg.line()
  .interpolate("step-after")
  .x(function(d) { return app.xScale(d.date); })
  .y(function(d) { return app.yScale(d.raised); });

// scales and axes initialization
app.xScale = d3.time.scale();
app.yScale = d3.scale.linear();
app.yAxis = d3.svg.axis();
app.yGrid = d3.svg.axis();
app.xAxis = d3.svg.axis();

// function that works on draw and resize
app.drawChart = function() {

  // set width and height
  app.updateDimensionsChart();

  // kill what exists
  d3.select("svg#tracker").remove();

  // set svg dimensions
  app.svg = d3.select("#chart").append("svg")
      .attr("id", "tracker")
      .attr("width", app.width + app.margin.left + app.margin.right)
      .attr("height", app.height + app.margin.top + app.margin.bottom)
    .append("g")
      .attr("transform", "translate(" + app.margin.left + "," + app.margin.top + ")");

  // set ranges based on calculated width and height
  app.xScale.range([0,app.width]);
  app.yScale.range([app.height,0]);

  // maximum date in our data
  var dmax = d3.max(app.cumulative, function(c) { return d3.max(c.values, function(d) { return d.date; }); });

  // x-axis should go to next six month mark
  var xmax;
  if (dmax.getMonth()<=5) {
    xmax = new Date(dmax.getFullYear(),6,1)
  } else {
    xmax = new Date(dmax.getFullYear()+1,0,1)
  }

  xmax = app.isMobile ? xmax : new Date(2019,0,1)

  // set domain based on calculated max
  app.xScale.domain([
    new Date(2015, 0, 1),
    xmax
  ]);

  // tick x-axis every six months
  app.tickCount = d3.time.months(app.xScale.domain()[0],app.xScale.domain()[1],6).length+1

  // maximum amount raised for any candidate
  var cmax = d3.max(app.cumulative, function(c) { return d3.max(c.values, function(d) { return d.raised; }); })

  // y-axis should go to next [n] million
  var margin = 5;
  var yceil = Math.ceil(cmax / (margin * 1000000));

  var ymax = yceil * margin * 1000000;

  // if (yceil % margin == 0) {
  //   ymax = yceil * margin * 1000000
  // } else {
  //   ymax = (yceil + margin) * margin * 1000000
  // }

  // ymax = ymax + 2000000; // extra buffer if labels get too close

  // set domain based on calculated max
  app.yScale.domain([0,ymax]);

  // settings for y-axis
  app.yAxis
    .scale(app.yScale)
    .orient("left")
    .ticks(ymax/(margin * 1000000))
    .tickFormat(function(d){return d/1000000});

  // settings for horizontal gridlines
  app.yGrid
    .scale(app.yScale)
    .orient("left")
    .ticks(ymax/(margin * 1000000))
    .tickFormat("")
    .tickSize(-(app.width),0); // negative inner tick size draws gridlines all the way across

  // add y-axis
  app.svg.append("g")
    .attr("class","y axis")
    .call(app.yAxis);

  // add gridlines
  app.svg.append("g")
    .attr("class","y grid")
    .call(app.yGrid);

  // settings for x-axis
  app.xAxis
    .scale(app.xScale)
    .orient("bottom")
    .ticks(d3.time.months,6)
    .tickFormat(function(d,i){
      if (app.isMobile === true) {
        // on mobile, label only first and last tick
        if (i === 0 | i === app.tickCount-2) {
          if (d.getMonth() === 6) {
            return "July " + d.getFullYear(); // copy desk fix
          } else {
            return d3.time.format("%b. %Y")(d);
          }
        } else {
          return "";
        }
      } else {
        // on desktop label every sixth tick (Jan./July)
        if (d.getMonth() === 0 && d.getFullYear() === 2019) {
          return ""
        }
        if (d.getMonth() === 6) {
          return "July " + d.getFullYear(); // copy desk fix
        } else {
          return d3.time.format("%b. %Y")(d);
        }
      }
    })
    .outerTickSize(0);

  // add x-axis
  app.svg.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0," + app.height + ")")
    .call(app.xAxis);

  if (!app.isMobile) {
    app.labelPrimary = app.svg.append('g')
      .attr("class", "vline primary")

    app.labelPrimary.append('line')
      .attr('x1',app.xScale(new Date(2018, 5, 5)))
      .attr('x2',app.xScale(new Date(2018, 5, 5)))
      .attr('y1',app.yScale(0))
      .attr('y2',app.yScale(ymax+1000000))
      .style('stroke','#666')
      .style('stroke-width','0.5px')
      .style('stroke-dasharray', '1')

    app.labelPrimary.append("text")
      .attr("transform", function(d) {
        return "translate(" +
          app.xScale(new Date(2018, 4, 22)) + "," +
          app.yScale(app.yScale.domain()[1]+500000) + ")";
      })
      .attr("x", 6)
      .attr("dy", "0.10em")
      .style("text-anchor",'end')
      .text('Primary');

    app.labelGeneral = app.svg.append('g')
      .attr("class", "vline general")

    app.labelGeneral.append('line')
      .attr('x1',app.xScale(new Date(2018, 10, 6)))
      .attr('x2',app.xScale(new Date(2018, 10, 6)))
      .attr('y1',app.yScale(0))
      .attr('y2',app.yScale(ymax+1000000))
      .style('stroke','#666')
      .style('stroke-width','0.5px')
      .style('stroke-dasharray', '1')

    app.labelGeneral.append("text")
      .attr("transform", function(d) {
        return "translate(" +
          app.xScale(new Date(2018, 9, 22)) + "," +
          app.yScale(app.yScale.domain()[1]+500000) + ")";
      })
      .attr("x", 6)
      .attr("dy", "0.10em")
      .style("text-anchor",'end')
      .text('General');
  }

  // use data to create empty g tags
  app.candidate = app.svg.selectAll(".candidate")
    .data(app.cumulative)
    .enter().append("g")
      .attr("class", "candidate")
      .attr("id", function(d) {return d.candidate.split(" ")[1].toLowerCase()});

  // shove a line into each g
  app.candidate.append("path")
    .attr("class", "line")
    .attr("d", function(d) { return app.lineDraw(d.values); })
    .style("stroke", function(d) { return app.colorScale(d.candidate); })
    .style("opacity", function(d) { return app.toptwo.indexOf(d.candidate) < 0 ? 0.2 : 1});

  // append text label at end
  app.candidate.append("text")
    .datum(function(d) {
      return {
        candidate: d.candidate.split(" ")[1],
        value: d.values[d.values.length - 1]
      };
    })
    .attr("transform", function(d) {
      return "translate(" + app.xScale(d.value.date) + "," + app.yScale(d.value.raised) + ")";
    })
    .attr("x", function(d) { return ['Newsom', 'Cox'].indexOf(d.candidate) < 0 ? 3 : 6})
    .attr("dy", "0.35em")
    .style("font", "12px sans-serif")
    .text(function(d) { return d.candidate; })
    .style("opacity", function(d) { return ['Newsom', 'Cox'].indexOf(d.candidate) < 0 ? 0.4 : 1});

  // append focus circle at end
  app.candidate.append("circle")
    .datum(function(d) {
      return {
        candidate: d.candidate,
        value: d.values[d.values.length - 1]
      };
    })
    .attr("transform", function(d) {
      return "translate(" + app.xScale(d.value.date) + "," + app.yScale(d.value.raised) + ")";
    })
    // .attr("r",4)
    .attr("r", function(d) { return app.toptwo.indexOf(d.candidate) < 0 ? 0 : 4})
    .attr("fill", function(d){
      return app.colorScale(d.candidate)
    })
    .style("opacity", function(d) { return app.toptwo.indexOf(d.candidate) < 0 ? 0 : 1});

  // place y-label atop highest gridline
  app.labelY = app.svg.append("g")
    .attr("class", "text-label")
  .append("text")
    .text("Cumulative total (in millions)")
    .attr("x",app.xScale(new Date(2015,0,1)))
    .attr("y",app.yScale(app.yScale.domain()[1]+550000));

}

// make chart div responsive to window width
app.updateDimensionsChart = function() {
    // margins for d3 chart
    app.margin = {top: 20, right: 30, bottom: 40, left: 40}; // change right to fit AV

    if (app.isMobile) {
      // app.margin.right=80;
    }

    // width of graphic depends on width of chart div
    app.chartElW = document.getElementById("chart").clientWidth;
    app.width = app.chartElW - app.margin.left - app.margin.right;

    // height depends only on mobile
    if (app.isMobile === true){
        app.height = 600 - app.margin.top - app.margin.bottom;
    } else {
        app.height = 500 - app.margin.top - app.margin.bottom;
    }
}


/*****

    MAP DATA PROCESSING

*****/

// size of the circles scaled with a sqrt transformation
app.calculateRadius = function (v){
  var transform = Math.sqrt(v*0.0001);
  return Math.round( 10* transform )/10;
}

// prep each row of the csv (currently one object per row of file)
app.prepCaRow = function (d){
  return {
    "Gavin Newsom": +d["Gavin Newsom"],
    "John Cox": +d["John Cox"],
    county: d["name_county"],
    lat: +d["lbl_latitude"],
    lon: +d["lbl_longitude"],
  }
}

// transform data to one object per candidate
app.prepCaData = function (rawdata){
  var data =_.map(rawdata, app.prepCaRow);
  var candidates = app.colorScale.domain().map(function(name){
    return {
      candidate: name,
      values: data.map(function(d){
        return {
          county: d.county,
          raised: d[name],
          radius: app.calculateRadius(d[name]), // put radius in data
        }
      })
    }
  })
  return candidates;
}

// create simple lookup for county lat/lng
app.prepCentroids = function (data){
  result = {}
  _.map(data, function(d) {
    result[d['name_county']] = {
      'lat': +d['lbl_latitude'],
      'lon': +d['lbl_longitude'],
    }
  })
  return result;
}

/*****

    MAP DRAWING

*****/


app.drawMap = function(name) {
  var last_name = name.split(" ")[1].toLowerCase();

  // set width and height
  app.updateDimensionsMap();

  // use the mercator projection
  app.projection = d3.geo.mercator()
    .scale(app.mapScale)
    .center([-118.4,37])
    .translate([app.mapWidth*0.5,app.mapHeight*0.5]);

  // path draws shapes per the specified projection
  app.mapPath = d3.geo.path().projection(app.projection);

  // kill what exists
  d3.select("svg#map"+last_name).remove();

  // set svg dimensions
  app['svg'+last_name] = d3.select(".map."+last_name)
    .append("svg")
      .attr("id", "map"+last_name)
      .attr("width", app.mapWidth + app.mapMargin.left + app.mapMargin.right)
      .attr("height", app.mapHeight + app.mapMargin.top + app.mapMargin.bottom)
    .append("g")
      .attr("transform", "translate(" + app.mapMargin.left + "," + app.mapMargin.top + ")");

  // make shape of california
  app['svg'+last_name].selectAll('path')
    .data(topojson.feature(app.california,app.california.objects.collection).features)
    .enter()
    .append('path')
    .style({stroke:'#fff','stroke-width':'.5px', fill:'#ddd'})
    .attr('d', app.mapPath);

  // filter down to our candidate
  app['mapData_'+last_name] = _.findWhere(app.counties, {candidate: name}).values;
  // sort so that bigger circles get drawn first
  app['mapData_'+last_name] = _.sortBy(app['mapData_'+last_name], function (d) { return d.radius; }).reverse();
  // draw circles for each county
  app['svg'+last_name].selectAll('circle')
    .data(app['mapData_'+last_name])
    .enter()
    .append('circle')
    .attr('class', 'money')
    .attr('cx', function(d){
      return app.projection([
        app.centroids[d.county].lon,
        app.centroids[d.county].lat,
      ])[0];
    })
    .attr('cy', function(d){
      return app.projection([
        app.centroids[d.county].lon,
        app.centroids[d.county].lat,
      ])[1];
    })
    .attr('r',function(d){return d.radius;})
    .style('fill', app.colorScale(name))
    .style('opacity', 0.6)
    .style('stroke-width', 0.0)
    .style('stroke', 'black');

  // draw circle for out of state totals
  app['svg'+last_name].append('circle')
    .attr('class', 'money')
    .attr('cx', app.projection([-117, 40.5])[0])
    .attr('cy', app.projection([-117, 40.5])[1])
    .attr('r', app.calculateRadius(app.outofstate[name]))
    .style('fill', app.colorScale(name))
    .style('opacity', 0.6)
    .style('stroke-width', 0.0)
    .style('stroke', 'black');

  // add labels/legend for each map
  if (name==='Gavin Newsom') {
    app.addLabel(app['svg'+last_name], 'Sacramento');
    app.addLabel(app['svg'+last_name], 'Los Angeles');
    app.addLabel(app['svg'+last_name], 'Out of state');
    app.createLegend(app['svg'+last_name]);
  }
  if (name==='John Cox') {
    app.addLabel(app['svg'+last_name], 'San Francisco');
    app.addLabel(app['svg'+last_name], 'San Diego');
  }
}


// make chart div responsive to window width
app.updateDimensionsMap = function() {
    // margins for d3 chart
    app.mapMargin = {top: 10, right: 10, bottom: 10, left: 10};

    if (app.isMobile) {
      app.mapWidth = 270 - app.mapMargin.left - app.mapMargin.right;
      app.mapHeight = 320 - app.mapMargin.top - app.mapMargin.bottom;
    } else {
      app.mapWidth = 350 - app.mapMargin.left - app.mapMargin.right;
      app.mapHeight = 450 - app.mapMargin.top - app.mapMargin.bottom;
    }

    app.mapScale = app.isMobile ? 1300 : 1650;
}


/*****

    LABELS

*****/

// the labels and their positions
app.cities = {
  'San Francisco': {
    'lat': 37.778008,
    'lon': -122.431272,
  },
  'Sacramento': {
    'lat': 38.57873,
    'lon': -121.466786,
  },
  'Los Angeles': {
    'lat': 34.05513,
    'lon': -118.25703,
  },
  'San Diego': {
    'lat': 32.7157,
    'lon': -117.1611,
  },
  'Anaheim': {
    'lat': 33.5010,
    'lon': -117.5323,
  },
  'Out of state': {
    'lat': 41.4,
    'lon': -118.45,
  },
}

app.addLabel = function (svg, label){

  // calculate position on screen from lat/long
  var ll = app.cities[label];
  var x = app.projection([ll.lon,ll.lat])[0];
  var y = app.projection([ll.lon,ll.lat])[1];

  if (label != 'Out of state') {
    svg.append('circle')
      .attr('class', 'city')
      .attr('cx', x)
      .attr('cy', y)
      .attr('r',1.5)
      .style('fill', 'black');
    
    svg.append("text")
      .attr('class', 'city')
      .attr("transform", "translate(" + x + "," + y + ")")
      .attr("x", 6)
      .attr("dy", "0.35em")
      .style("font", "11px sans-serif")
      .text(label);
  }

  else {
    svg.append("text")
    .attr('class', 'city')
    .attr("transform", "translate(" + x + "," + y + ")")
    .attr("x", 15)
    .attr("dy", "0.35em")
    .style("font", "11px sans-serif")
    .text(label);
  }

}

/*****

    LEGEND

*****/

// done with http://d3-legend.susielu.com/

app.createLegend = function (svg) {

  // ordinal scale to manually set legend icons
  var linearSize = d3.scale.ordinal()
    .domain([1000000,3000000,7000000])
    .range([app.calculateRadius(1000000),app.calculateRadius(3000000),app.calculateRadius(7000000)])

  // moving legend on page
  svg.append("g")
    .attr("class", "legendSize")
    .attr("transform", "translate(0," + (app.isMobile ? 240 : 320) + ")");

  // set options
  var legendSize = d3.legend.size()
    .scale(linearSize)
    .cells(3)
    .ascending(true)
    .shape('circle')
    .shapePadding(14)
    .labelOffset(app.isMobile ? 9 : 13)
    .title('County total')
    .labels(['$1M','$3M', '$7 million'])
    .orient('horizontal');

  // create legend
  svg.select(".legendSize")
    .call(legendSize);

  // override some default styles
  svg.selectAll('.legendCells text')
    .style('font','10px sans-serif')
    .style('text-shadow', 'none');

  svg.select('text.legendTitle')
    .style('font','11px sans-serif');

  svg.selectAll('.legendSize circle')
    .style('stroke-width', 0.5)
    .style('stroke', 'black')
    .style('fill', 'none');
}



</script>

    <script type="text/javascript">
        function loadaml(filepath, callback){
          $.ajax(filepath,{
            success:function(res){
              callback(null, res)
            }
          })
        }
        $(function () {
          queue()
            .defer(d3.csv, 'static/data/candidate-cumulative-fundraising.csv')
            .defer(d3.json, 'static/js/ca-counties-simple.json')
            .defer(d3.csv, 'static/data/candidate-counties-centroids.csv')
            .defer(d3.csv, 'static/data/outofstate.csv')
            .await(app.boot);
        });
    </script>


    

<script type="text/javascript">
var _sf_async_config={};
    /** CONFIGURATION START **/
    _sf_async_config.uid = 3908;
    _sf_async_config.domain = 'latimes.com';
    _sf_async_config.useCanonical = true;
    _sf_async_config.sections = 'bigbuilder';
    _sf_async_config.authors = 'Ryan Menezes and Maloy Moore';
    _sf_async_config.title = "Track the millions flowing into California&#39;s race for governor";
    /** CONFIGURATION END **/
    (function(){
      function loadChartbeat() {
        window._sf_endpt=(new Date()).getTime();
        var e = document.createElement('script');
        e.setAttribute('language', 'javascript');
        e.setAttribute('type', 'text/javascript');
        e.setAttribute('src', '//static.chartbeat.com/js/chartbeat.js');
        document.body.appendChild(e);
      }
      var oldonload = window.onload;
      window.onload = (typeof window.onload != 'function') ?
         loadChartbeat : function() { oldonload(); loadChartbeat(); };
    })();
</script>



</body>
</html>
